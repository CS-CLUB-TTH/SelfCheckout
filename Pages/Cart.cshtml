@page
@model CartModel
@{
    ViewData["Title"] = "Shopping Cart";
    Layout = "_KioskLayout";
}

<div class="cart-screen">
    <div class="cart-header">
        <div class="cart-header-graphic">
            <img src="~/Graphic.svg" alt="Graphic" />
        </div>
        <h1>Your Cart</h1>
    </div>
    
    @if (!string.IsNullOrEmpty(Model.ErrorMessage))
    {
        <div class="alert alert-warning text-center" role="alert" style="margin: 20px 60px; font-size: 18px; padding: 15px; border-radius: 12px;">
            <strong>@Model.ErrorMessage</strong>
        </div>
    }
    
    <div class="cart-content">
        <div class="cart-items-container">
            @if (Model.CartItems.Any())
            {
                <div class="cart-items">
                    @foreach (var item in Model.CartItems)
                    {
                        <div class="cart-item">
                            <div class="item-info">
                                <div class="item-name">@item.ProdBillDesc</div>
                                @if (!string.IsNullOrEmpty(item.OrderedBy))
                                {
                                    <div class="item-details">Ordered by: @item.OrderedBy</div>
                                }
                                @if (!string.IsNullOrEmpty(item.CourseDesc))
                                {
                                    <div class="item-details">@item.CourseDesc</div>
                                }
                            </div>
                            <div class="item-quantity">x @item.Qty.ToString("0.##")</div>
                            <div class="item-price">AED @item.Amount.ToString("0.00")</div>
                        </div>
                    }
                </div>
            }
            else
            {
                <div class="empty-cart-message">
                    <div class="empty-cart-icon">ðŸ›’</div>
                    <h2 class="empty-cart-title">Your cart is empty</h2>
                    <p class="empty-cart-text">Scan your NFC card to load your items</p>
                </div>
            }
        </div>
    </div>
    
    @if (Model.CartItems.Any())
    {
        <div class="cart-footer">
            <div class="cart-summary-container">
                <div class="cart-summary">
                    <div class="summary-row">
                        <span>Subtotal:</span>
                        <span>AED @Model.Subtotal.ToString("0.00")</span>
                    </div>
                    @if (Model.Tax > 0)
                    {
                        <div class="summary-row">
                            <span>Tax (VAT):</span>
                            <span>AED @Model.Tax.ToString("0.00")</span>
                        </div>
                    }
                    <div class="summary-row summary-total">
                        <span>Total:</span>
                        <span>AED @Model.Total.ToString("0.00")</span>
                    </div>
                </div>
            </div>

            <div class="cart-footer-buttons">
                <button class="btn-kiosk btn-cancel">Cancel Order</button>
                <button class="btn-kiosk btn-proceed">Proceed to Payment</button>
            </div>
        </div>
    }
    else
    {
        <div class="cart-footer">
            <div class="cart-footer-buttons" style="justify-content: center;">
                <button class="btn-kiosk btn-cancel" onclick="window.location.href='/'" style="max-width: 400px;">Return to Home</button>
            </div>
        </div>
    }
</div>

